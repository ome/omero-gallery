
{% extends "webgallery/categories/base.html" %}

{% block content %}

<script>
  // Various global constants from bin/omero config set...
  const IDR_TYPE = "{{ idr_type }}";
  var FILTER_KEYS = {{ filter_keys|escape|safe }};
  var FILTER_MAPR_KEYS = {{ filter_mapr_keys|escape|safe }};
  const GALLERY_INDEX = "{% url 'webgallery_index' %}";
  const BASE_URL = "{{ base_url }}";
  const CATEGORY_QUERIES = {{ category_queries|escape|safe }};
  var SUPER_CATEGORY {% if super_category %} = {{ super_category|escape|safe }} {% endif %};
</script>

<hr class="whitespace" style="height: 0">

<div class="row column text-center">
  {% if gallery_title %}<h1>{{ gallery_title }}</h1>{% endif %}

<div class="small-10 small-centered medium-10 medium-centered columns">

    <div class="row horizontal">

      <div class="small-12 medium-12 large-2 columns">
        <h2>Search by:</h2>
      </div>
      <div style="padding:0" class="small-12 medium-4 large-3 columns">
        <select id="maprConfig">
          <optgroup id="studyKeys" label="Study Attributes">
            <!-- Map-Annotation keys loaded here -->
          </optgroup>
          <optgroup id="maprKeys" label="Image Attributes">
          </optgroup>
        </select>
      </div>
      <div class="small-12 medium-8 large-7 columns">
        <input id="maprQuery" type="text" placeholder="Publication Authors">
      </div>
    </div>

    {% if not super_category %}
      <div class="row horizontal">
      {% for category, data in super_categories.items %}
        <a href="{{ category }}/">
          <div class="small-6 medium-6 large-6 columns" style="position: relative;">
            <img class="thumbnail" src="{{ data.image }}" />
            <div class="img_overlay">
              <span class="overlay_text">{{ data.label }}</span>
            </div>
          </div>
        </a>
      {% endfor %}
      </div>
    {% endif %}

    <div id="filterCount" class="row horizontal">
    </div>
</div>

<div id="studies" class="row horizontal">
  Loading Studies...
  <script>
      function studyHtml(studyLink, studyDesc, idrId, title, authors, BASE_URL) {
    return `
    <a target="_blank" href="${ studyLink }">
      <div class="studyBackground" style="padding: 0">
        <img class="studyImage" src="" />
      </div>
      <div class="studyText">
        <p title="${ studyDesc }">
          <span style='color:#1976d2'>${ idrId }</span>:
          ${ title }
        </p>
      </div>
      <div class="studyAuthors">
        ${ authors }
      </div>
    </a>
    <a class="viewerLink" title="Open image in viewer" target="_blank"
       href="">
      <i class="fas fa-eye"></i>
    </a>
    `
  }
  </script>
</div>

<script src="{% static 'gallery/categories.js' %}"></script>

{% endblock %}
