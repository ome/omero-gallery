
{% extends "webgallery/categories/base.html" %}

{% block content %}

<script>
  // Various global constants from omero config set...
  var FILTER_KEYS = {{ filter_keys|escape|safe }};
  var FILTER_MAPR_KEYS = {{ filter_mapr_keys|escape|safe }};
  var TITLE_KEYS = {{ TITLE_KEYS|escape|safe }};
  var STUDY_SHORT_NAME = {{ STUDY_SHORT_NAME|escape|safe }};
  const GALLERY_INDEX = "https://idr.openmicroscopy.org/"    // "{% url 'webgallery_index' %}";
  const BASE_URL = "{{ base_url }}";
  const CATEGORY_QUERIES = {{ category_queries|escape|safe }};
  var SUPER_CATEGORY {% if super_category %} = {{ super_category|escape|safe }} {% endif %};
</script>

<script src="https://unpkg.com/@popperjs/core@2"></script>
<script src="https://unpkg.com/tippy.js@6"></script>
<link rel="stylesheet" href="https://unpkg.com/tippy.js@6/dist/backdrop.css" />
<link rel="stylesheet" href="https://unpkg.com/tippy.js@6/themes/light-border.css" />

<style>

  body {
    background-color: #f6f6f9;
  }

  header div {
    position: relative;
  }

  .marketing-hero {
    overflow: hidden;
    position: relative;
    padding: 40px 10px 25px;
    background: black;
    box-shadow: 1px 1px 3px 0px rgb(0 0 0 / 50%);
  }

  .marketing-background {
    position: absolute;
    background-position: center;
    width: 100%;
    background-size: cover;
    background-image: url('https://idr.openmicroscopy.org/webclient/render_image/13965767/294/0/');
    height: 400px;
    height: 100%;
    top: 0;
    left: 0;
    transition: left 1s;
  }

  .prev {
    left: -100%
  }
  .next {
    left: 100%
  }

  .bg_controls {
    position: absolute;
    right: 5px;
    top: 5px;
    color: white;
    font-size: 200%;
    display: flex;
  }

  .bg_controls div {
    width: 14px;
    height: 14px;
    border: solid white 1px;
    border-radius: 50%;
    cursor: pointer;
    margin: 7px;
    background-color: transparent;
    opacity: 0.75;
    transition: border-color 1s, background-color 1s
  }

  .dark .bg_controls div {
    border-color: #222222;
  }

  .bg_controls .selected {
    background-color: rgba(255, 255, 255, .9);
  }
  .dark .bg_controls .selected {
    background-color: rgba(0, 0, 0, 0.5);
  }

  .bg_controls div:hover {
    opacity: 0.5;
  }

  a.sites-button.large {
    min-width: 150px;
    font-size: 1.15rem;
    display: block;
    width: fit-content;
    margin: 15px 7px;
  }
  .cats {
    display: flex;
    justify-content: center;
  }
  #search-form {
    padding-top: 10px;
  }
  .hero-subheader {
    margin-bottom: 5px;
    font-size: 1.15rem;
    transition: background-color 1s, color 1s, box-shadow 1s;
  }
  .dark .hero-subheader {
    color: #333333;
    background-color: rgba(255, 255, 255, 0.5);
    box-shadow: 0px 0px 15px 15px rgb(255 255 255 / 50%);
  }
  .stats {
    position: relative;
    text-align: center;
    font-size: 1.7rem;
    color: black;
  }
  .stats span {
    color: #dddddd;
  }
  .studyThumb {
    float: left;
    position: relative;
    margin: 1px;
    margin-top: 1px;
    height: 50px;
    width: 50px;
    overflow: hidden;
  }
  .studyImage {
    position: relative;
    height: 100%;
    width: fit-content;
    max-width: none;
    background: no-repeat center;
    background-size: cover;
    position: relative;
    border-radius: 0;
  }

  .switchLabel {
    font-size: 1.0rem;
    display: inline;
    vertical-align: middle;
    position: relative;
    bottom: 1px;
    color: #999;
  }

  /* https://www.w3schools.com/howto/howto_css_switch.asp */
  /* The switch - the box around the slider */
.switch {
  position: relative;
  display: inline-block;
  width: 33px;
  height: 20px;
}

/* Hide default HTML checkbox */
.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

/* The slider */
.sliderToggle {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.sliderToggle:before {
  position: absolute;
  content: "";
  height: 16px;
  width: 16px;
  left: 2px;
  bottom: 2px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .sliderToggle {
  background-color: #333333;
}

input:checked + .sliderToggle:before {
  -webkit-transform: translateX(13px);
  -ms-transform: translateX(13px);
  transform: translateX(13px);
}

/* Rounded sliders */
.sliderToggle.round {
  border-radius: 9px;
}

.sliderToggle.round:before {
  border-radius: 50%;
}

.panel {
  background: white;
  -webkit-box-shadow: 1px 1px 3px 0px rgba(0,0,0,0.5); 
  box-shadow: 1px 1px 3px 0px rgba(0,0,0,0.5);
  padding: 15px;
  width: 100%;
}

.panel .tabs {
  border-width: 0;
  border-bottom-width: 1px;
}

.tabs-title>a[aria-selected=true] {
  background: transparent;
  border-bottom: solid #333 2px;
}
.tabs-title>a:focus {
  background: transparent;
}

/* .twitter-timeline is just while loading twitter */
.tabs-title.is-active a, .tabs-title a, .panel>a.twitter-timeline {
  color: #292F33;
  font-weight: 300;
  font-family: Helvetica,Roboto,"Segoe UI",Calibri,sans-serif;
  font-size: 21px;
  line-height: 24px;
  padding: 5px 25px 9px 25px;
  margin-bottom: -1px;
}
.tabs-content {
  border: none;
}
.tabs-panel {
  padding: 15px 0;
}
.tabs-panel .row {
  margin-bottom: 15px;
}

.tabs-panel .large-6 iframe {
  height: 156px;
}
.tabs-panel .large-12 iframe {
  height: 312px;
}

.expandVideo {
  position: absolute;
  bottom: 0;
  right: -5px;
}

.large-12 .expandVideo {
  transform: rotate(180deg);
}

.logo-hero{
  opacity: 1;
  transition: opacity 1s;
}

.dark .logo-hero{
  opacity: 0;
}
</style>


<header class="marketing-hero">
  <div class="marketing-background"></div>
  <div class="marketing-background next" data-light="true" style="background-image: url(https://idr.openmicroscopy.org/webgateway/render_image_region/13461816/0/0/?tile=3,2,4,1024,512"></div>
  <div class="marketing-background next"
    style="background-image: url(https://idr.openmicroscopy.org/webgateway/render_image_region/9846152/45/0/?tile=4,0,0,1024,512)">
  </div>
  <div class="marketing-background next" data-light="true"
    style="background-image: url(https://idr.openmicroscopy.org/webgateway/render_image_region/13383922/0/0/?region=412,1224,1536,1024">
  </div>
  <div class="marketing-background next" style="background-image: url(https://idr.openmicroscopy.org/webclient/render_image/4995045/0/0/)"></div>
  <div class="marketing-background next" style="background-image: url(https://idr.openmicroscopy.org/webgateway/render_image/9846154/268/0/?region=1024,0,2048,1024&c=1|4283:12901$FF00FF,2|1278:8356$FFFF00)"></div>
  <div class="marketing-background next"
    style="background-image: url(https://idr.openmicroscopy.org/webclient/render_image/9753804/0/0/)"></div>
  <div class="marketing-background next"
    style="background-image: url(https://idr.openmicroscopy.org/webgateway/render_image/9836841/0/0/); background-position-y: 15%;">
  </div>

  
  <div class="bg_controls">
    <div class="selected" title="idr0124 Esteban: Heart morphogenesis"></div>
    <div title="idr0096 Tratwal: Marrowquant"></div>
    <div title="idr0048 Abdeladim: Chroms"></div>
    <div title="idr0043 Uhlen: Human Protein Atlas"></div>
    <div title="idr0050 Springer: Cyto-skeletal systems"></div>
    <div title="idr0085 Walsh: MF-HREM"></div>
    <div title="idr0056 Stojic: Long noncoding RNA"></div>
    <div title="idr0077 Valuchova: Flower lightsheet"></div>
  </div>
  
  
    <div class="row homepage text-center">
    <div class="medium-12 columns">
      <div style="display: inline-block; position: relative; width:160px; height:62px; margin-bottom: 20px;">
        <img style="left: 0; position: absolute; width:160px; margin-bottom: 20px;" src="{% static 'gallery/images/logo-idr-dark.svg' %}" alt="IDR logo" class="logo-dark"/>
        <img style="left: 0; position: absolute; width:160px; margin-bottom: 20px;" src="https://idr.openmicroscopy.org/about/img/logos/logo-idr-white.svg" alt="IDR logo" class="logo-hero">
      </div>
      <!-- <h1 class="hero-main-header">Image Data Resource</h1> -->
      <h2 class="hero-subheader small-10 medium-10 large-10 small-offset-1 medium-offset-1 large-offset-1">
        The Image Data Resource (IDR) is a public repository of image datasets from published scientific studies,
        where the community can submit, search and access high-quality bio-image data.
      </h2>
      <div class="cats">
      {% for category, data in super_categories.items %}
      <a href="{{ category }}/" class="large button sites-button" style="margin-right: 10px">{{ data.label }}</a>
      {% endfor %}
      </div>
    </div>
  </div>

  <div id='search-form' class="row horizontal">
    <div class="small-12 medium-4 large-4 columns">
      <select id="maprConfig">
        <optgroup id="studyKeys" style='display:none' label="Study Attributes">
          <!-- Study keys loaded here -->
        </optgroup>
        <optgroup id="maprKeys" style='display:none' label="Image Attributes">
          <!-- Map-Annotation keys loaded here -->
        </optgroup>
      </select>
    </div>
    <div style="position: relative" class="small-12 medium-8 large-8 columns">
      <input id="maprQuery" type="text" placeholder="Type to filter values...">
      <svg id="spinner" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sync" role="img"
        xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-sync fa-w-16 fa-spin fa-lg">
        <path fill="currentColor"
          d="M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"
          class=""></path>
      </svg>
    </div>
  </div>
</header>

<div class="row horizontal" style="position: relative; margin-top: 25px; margin-bottom: 15px">
  <div class="small-12 medium-12 large-12 columns">
    <div class="panel" style="float: left; width: 100%">
      <div class="small-12 medium-1 large-2 columns">&nbsp</div>
      <div class="stats small-12 medium-9 large-8 columns" style="position: relative">
        12 Million Images <span>|</span> 300 TB <span>|</span> 102 Studies
      </div>
      <div class="stats small-12 medium-2 large-2 columns" >&nbsp
        <div style="position: absolute; top: 0; right: 15px; width: max-content;">
          <label class="switchLabel">Group by type</label>
          <label class="switch">
            <input id="groupByType" type="checkbox">
            <span class="sliderToggle round"></span>
          </label>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row horizontal" style="position: relative">
  <div class="small-12 medium-12 large-12 columns">
    <div id="studies" class="panel" style="float: left">
      Loading Studies...
    </div>
  </div>
</div>

<div class="row horizontal" style="position: relative; margin-top: 15px; margin-bottom: 15px">
  <div class="stats small-12 medium-9 large-8 columns" style="position: relative">
  </div>
</div>

<div class="row horizontal" style="position: relative;">
  <div class="small-12 medium-12 large-8 columns" style>
    <div class="panel">
      <ul class="tabs" data-tabs id="example-tabs">
        <li class="tabs-title is-active"><a href="#panel1" aria-selected="true">
          Getting Started
        </a></li>
        <li class="tabs-title"><a data-tabs-target="panel2" href="#panel2">
          Case Studies
        </a></li>
        <li class="tabs-title"><a data-tabs-target="panel3" href="#panel3">
          Analysis Notebooks
        </a></li>
      </ul>
      <div class="tabs-content" data-tabs-content="example-tabs">
        <div class="tabs-panel is-active" id="panel1">
          <div class="row horizontal">
            <div class="small-6 medium-6 large-6 columns" style="position: relative;">
              <!-- width="607" height="378" -->
              <iframe id="youtube" width="100%" height="100%" src="https://www.youtube.com/embed/WP53Q7gMg3Y"
                title="YouTube video player" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
              </iframe>
              <button class="expandVideo">>></button>
            </div>
            <div class="columns small-6 medium-6 large-6">
              <p>Getting started with searching the IDR for images associated with a Gene of interest</p>
            </div>
          </div>
          <div class="row horizontal">
            <div class="small-6 medium-6 large-6 columns" style="position: relative;">
              <!-- width="607" height="378" -->
              <iframe id="youtube" width="100%" height="150" src="https://www.youtube.com/embed/XvbHczzePSo"
                title="YouTube video player" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
              </iframe>
              <button class="expandVideo">>></button>
            </div>
            <div class="small-6 medium-6 large-6 columns">
              Link from a paper to a study in IDR and explore ROI (regions of interest)
            </div>
          </div>
          <div class="row horizontal">
            <div class="small-6 medium-6 large-6 columns" style="position: relative;">
              <iframe id="youtube" width="100%" height="150" src="https://www.youtube.com/embed/M_bkI6bD0Wk"
                title="YouTube video player" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
              </iframe>
              <button class="expandVideo">>></button>
            </div>
            <div class="small-6 medium-6 large-6 columns">
              Search for a Compound from the top links, link to PubChem, cross-study search.
            </div>
          </div>
        </div>
        <div class="tabs-panel" id="panel2">
          <p>
            Case studies:
            <ul>
              <li>idr0101: 4DN chromosome browser</li>
              <li></li>
            </ul>
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="small-12 medium-12 large-4 columns">
    <div class="panel" style="padding: 10px">
    <a class="twitter-timeline" data-height="610" href="https://twitter.com/IDRnews?ref_src=twsrc%5Etfw">Tweets by
      IDRnews</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>    </div>
  </div>
</div>

</div>

<script src="{% static 'gallery/categories.js' %}"></script>

<script>
  $(".expandVideo").on("click", function() {
    let $row = $(this).closest(".row");
    // toggle from 2 columns to 1
    $('.columns', $row).toggleClass("small-12 medium-12 large-12")
    .toggleClass("small-6 medium-6 large-6");
  });

  function renderHeaderBg(clickedIndex) {
    var isLight;
    $(".marketing-background").each(function (index, el) {
      $(el).css('left', (clickedIndex - index) * -100 + '%');
      if (clickedIndex == index) {
        isLight = $(el).data("light");
      }
    });
    $(`.bg_controls div`).removeClass('selected');
    $(`.bg_controls div:nth-child(${clickedIndex + 1})`).addClass('selected');

    if (isLight) {
      $(".marketing-hero").addClass("dark");
    } else {
      $(".marketing-hero").removeClass("dark");
    }
  }

  // header background carousel controls
  $(".bg_controls div").on("click", function(event) {
    let $target = $(event.target);
    let clickedIndex = $(".bg_controls div").removeClass('selected').index($target);
    renderHeaderBg(clickedIndex);
  });

    function logKey(e) {
      let $selected = $(".bg_controls .selected");
      let index = $(".bg_controls div").index($selected);
      let count = $(".bg_controls>div").length;
      if (e.code == "ArrowRight" && (index + 1) < count) {
        index += 1;
      } else if (e.code == "ArrowLeft" && index > 0) {
        index -= 1;
      }
      renderHeaderBg(index);
    }
    document.addEventListener('keyup', logKey);
</script>

{% endblock %}
